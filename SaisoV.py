from WLS import wls
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import time
# from matplotlib.pylab import rcParams
from case118_n import case118n
from pypower.api import ppoption, runpf
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from keras.models import Sequential, load_model
from keras.layers import Dense, Activation, Dropout
from keras import optimizers
from matplotlib.pylab import rcParams
rcParams['figure.figsize'] = 15, 5

rcParams['figure.figsize'] = 15, 5
nbus=41
#====================================chuagiam

# ssV_MLP = [1,0.080039642,0.08897588,0.092110065,0.090987874,0.06768675,0.079954796,0.184528214,0.070425451,0.083786375,0.023185371,0.073711638,0.079735287,0.077296221,0.085843823,0.062137373,0.071342222,0.068580606,0.067176802,0.085703645,0.093442483,0.092853554,0.037198737,0.002640223,0.178591244,0.169233219,0.072825628,0.087699562,0.077563096,0.100825574,0.086398893,0.09272094,0.130045135,0.229096339,0.337749074,0.342787304,0.151527572,0.004428658,0.046730957,0.13277437,0.166036406]
# ssV_RFR = [1,0.0000,0.0004,0.0004,0.0004,0.0004,0.0000,0.0046,0.0003,0.0000,0.0021,0.0000,0.0004,0.0005,0.0000,0.0001,0.0001,0.0001,0.0040,0.0040,0.0000,0.0000,0.0031,0.0009,0.0811,0.0811,0.0000,0.0000,0.0003,0.0833,0.0000,0.0004,0.0021,0.0823,0.0783,0.0890,0.0035,0.0024,0.0078,0.0030,0.0027]
# ssV_WLS = [1,0.0577,0.0591,0.0591,0.0591,0.0591,0.0554,0.0560,0.0022,0.0019,0.0006,0.0000,0.0017,0.0011,0.0000,0.0129,0.0129,0.0060,0.0040,0.0040,0.0011,0.0011,0.0083,0.0677,0.0080,0.0080,0.0793,0.0793,0.0636,0.0005,0.0586,0.0590,0.0700,0.0082,0.0085,0.0005,0.0022,0.0022,0.0007,0.0041,0.0019]
#====================================25%
# ssV_MLP = [0,0.0996,0.1228,0.1099,0.1127,0.1099,0.0962,0.0771,0.1180,0.1063,0.2411,0.1032,0.1155,0.1448,0.0986,0.1448,0.1143,0.1011,0.0948,0.1103,0.1026,0.1002,0.2016,0.1764,0.0208,0.0215,0.1098,0.1033,0.1067,0.0720,0.1086,0.1043,0.3860,0.0152,0.1107,0.1083,0.0952,0.0462,0.0233,0.0760,0.1675]
# ssV_RFR = [0,0.0000,0.0004,0.0004,0.0004,0.0004,0.0000,0.0046,0.0003,0.0000,0.0022,0.0000,0.0004,0.0006,0.0000,0.0001,0.0002,0.0001,0.0040,0.0040,0.0000,0.0000,0.0032,0.0010,0.0811,0.0811,0.0000,0.0000,0.0004,0.0822,0.0000,0.0004,0.0024,0.0822,0.0781,0.0822,0.0035,0.0025,0.0079,0.0030,0.0066]
# ssV_WLS = [0,0.0577,0.0591,0.0591,0.0591,0.0591,0.0554,0.0560,0.0022,0.0019,0.0006,0.0000,0.0017,0.0011,0.0000,0.0129,0.0129,0.0060,0.0040,0.0040,0.0011,0.0011,0.0083,0.0677,0.0080,0.0080,0.0793,0.0793,0.0636,0.0005,0.0586,0.0590,0.0700,0.0082,0.0085,0.0005,0.0022,0.0022,0.0007,0.0041,0.0019]
#====================================50%
# ssV_MLP = [0,0.0996,0.1228,0.1099,0.1127,0.1099,0.0962,0.0771,0.1180,0.1063,0.2411,0.1032,0.1155,0.1448,0.0986,0.1448,0.1143,0.1011,0.0948,0.1103,0.1026,0.1002,0.2016,0.1764,0.0208,0.0215,0.1098,0.1033,0.1067,0.0720,0.1086,0.1043,0.3860,0.0152,0.1107,0.1083,0.0952,0.0462,0.0233,0.0760,0.1675]
# ssV_RFR = [0,0.0000,0.0004,0.0004,0.0004,0.0004,0.0000,0.0046,0.0003,0.0000,0.0022,0.0000,0.0004,0.0006,0.0000,0.0001,0.0002,0.0001,0.0040,0.0040,0.0000,0.0000,0.0032,0.0010,0.0811,0.0811,0.0000,0.0000,0.0004,0.0822,0.0000,0.0004,0.0024,0.0822,0.0781,0.0822,0.0035,0.0025,0.0079,0.0030,0.0066]
# ssV_WLS = [0,0.0577,0.0591,0.0591,0.0591,0.0591,0.0554,0.0560,0.0022,0.0019,0.0006,0.0000,0.0017,0.0011,0.0000,0.0129,0.0129,0.0060,0.0040,0.0040,0.0011,0.0011,0.0083,0.0677,0.0080,0.0080,0.0793,0.0793,0.0636,0.0005,0.0586,0.0590,0.0700,0.0082,0.0085,0.0005,0.0022,0.0022,0.0007,0.0041,0.0019]
#====================================25% 50%data
ssV_RFR = [0,0.0408,0.0317,0.0000,0.0014,0.0000,0.0331,0.0000,0.0077,0.0000,0.0094,0.0000,0.0315,0.0419,0.0000,0.0112,0.0087,0.0000,0.0000,0.0089,0.0319,0.0010,0.0461,0.0000,0.0000,0.0000,0.0000,0.0450,0.0222,0.0326,0.0000,0.0000,0.0077,0.0000,0.0460,0.0000,0.0347,0.0262,0.0038,0.0000,0.0176,0.0000,0.0116,0.0437,0.0394,0.0000,0.0033,0.0360,0.0000,0.0082,0.0135,0.0205,0.0040,0.0000,0.0000,0.0000,0.0434,0.0035,0.0000,0.0157,0.0000,0.0000,0.0280,0.0273,0.0000,0.0000,0.0315,0.0248,0.0000,0.0000,0.0159,0.0000,0.0000,0.0000,0.0331,0.0000,0.0000,0.0426,0.0226,0.0000,0.0196,0.0473,0.0371,0.0303,0.0000,0.0318,0.0000,0.0463,0.0000,0.0000,0.0000,0.0000,0.0424,0.0192,0.0308,0.0261,0.0147,0.0478,0.0000,0.0000,0.0421,0.0132,0.0000,0.0000,0.0000,0.0151,0.0000,0.0214,0.0020,0.0000,0.0000,0.0000,0.0000,0.0095,0.0021,0.0000,0.0188,0.0449]
ssV_MLP = [0,0.0172,0.0261,0.0018,0.0291,0.0008,0.0661,0.0013,0.0036,0.0020,0.0146,0.0008,0.0899,0.0579,0.0022,0.0506,0.0364,0.0173,0.0012,0.0772,0.0019,0.0625,0.0877,0.0549,0.0020,0.0013,0.0012,0.0570,0.0140,0.0226,0.0016,0.0011,0.0306,0.0007,0.0355,0.0013,0.0501,0.0578,0.0098,0.0022,0.0115,0.0013,0.0179,0.0388,0.0015,0.0491,0.0208,0.0152,0.0017,0.0144,0.0015,0.0026,0.0039,0.0018,0.0019,0.0015,0.0182,0.0466,0.0009,0.0135,0.0004,0.0018,0.0246,0.0282,0.0024,0.0020,0.0378,0.0179,0.0018,0.0017,0.0317,0.0013,0.0002,0.0006,0.0429,0.0007,0.0139,0.0537,0.0033,0.0015,0.0267,0.0267,0.0141,0.0645,0.0013,0.1052,0.0013,0.0064,0.0004,0.0009,0.0014,0.0008,0.0083,0.0384,0.0260,0.0091,0.0113,0.0549,0.0015,0.0009,0.0065,0.0390,0.0109,0.0021,0.0118,0.0033,0.0019,0.0059,0.0195,0.0400,0.0013,0.0017,0.0050,0.0315,0.0043,0.0003,0.0157,0.1002]
ssV_WLS = [0,0.038902163,0.031095041,0.007329659,0.006209581,0.005708081,0.03791911,0.01084532,0.004099712,0.000655238,0.01166802,0.00059697,0.035327479,0.037389228,0.030707216,0.024949187,0.041670352,0.034643371,0.032637214,0.041551724,0.025254697,0.027820433,0.020875876,0.05705746,0.000397143,0.009024631,0.011291322,0.030966736,0.039201454,0.067702538,0.017414685,0.009616822,0.020663234,0.013053862,0.052136735,0.007095918,0.016273461,0.11648283,0.396853608,0.357159794,0.478565667,0.91959797,0.010190379,0.490650407,0.177240365,0.002314428,0.263457227,0.09784525,0.017630244,0.015118881,0.118722854,0.072943574,0.024724101,0.043446073,0.040031513,0.053447589,0.08430896,0.247210636,0.106484264,0.002121853,0.031097487,0.180447896,0.039142415,0.049961382,0.178343284,0.404784762,0.873960784,0.166544367,4.92147E-05,0.023887195,0.001672746,0.014542857,0.013908174,0.103742171,0.027765253,0.430658537,0.702246521,1.009465603,1.22983449,0.023369231,0.160857573,0.247263903,0.450912602,0.322381633,0.080920812,0.472410334,0.749053202,0.872791287,0.001323383,0.525297462,0.691391837,0.444336364,0.865969543,0.10819596,0.399990816,0.466018145,1.226746785,0.599015625,0.389334653,0.305930187,0.123933401,0.525930233,0.290580198,0.261907312,0.225646632,0.191863684,0.211065126,0.116653209,0.124615305,0.085784173,0.002053061,0.072591795,0.033311178,0.01959375,0.012391667,0.190879602,0.021065708,0.203312961]
i = np.ones((118, 1), dtype=int)
for n in range(118):
    i[n] = n+1



plt.plot(i, ssV_MLP, 'bo-', label='MLP')
plt.plot(i, ssV_RFR, 'yo-', label='RFR')
plt.plot(i, ssV_WLS, 'go-', label='WLS')
# plt.title('Sai số góc pha của của lưới Tây Ninh')
plt.xlabel('Bus')
plt.ylabel('Error (%)')
plt.legend(loc='best')
plt.show()