from WLS import wls
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import time
# from matplotlib.pylab import rcParams
from case118_n import case118n
from pypower.api import ppoption, runpf
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from keras.models import Sequential, load_model
from keras.layers import Dense, Activation, Dropout
from keras import optimizers
from matplotlib.pylab import rcParams
rcParams['figure.figsize'] = 15, 5

rcParams['figure.figsize'] = 15, 5
nbus=41
#====================================chuagiam

# ssA_MLP = [0,0.316154508,0.304824619,0.283108366,0.372777944,0.357586326,1.741550877,0.169806794,0.477408259,0.452570187,1.48011638,8.891046043,1.099101576,3.115026139,0.699729393,0.319882036,0.238924347,0.269868178,4.22496352,3.435192412,2.438084036,1.571543971,1.183363876,0.198608083,0.152243731,0.106001469,0.144302499,0.193526301,0.251016502,0.095273443,0.17959063,0.364486945,0.812989722,1.131105057,0.414710929,1.014174633,1.477016371,1.364798361,1.538028044,1.716856975,3.710297876]
# ssA_RFR = [0,0.0526,0.0453,0.0455,0.0455,0.0455,0.0843,0.0097,0.0550,0.0550,0.0007,0.0216,0.0540,0.0307,0.0105,0.0157,0.0161,1.1628,4.5540,4.5531,2.7312,2.7311,0.2774,0.0433,0.2295,0.2295,0.0336,0.0336,0.0299,0.2028,0.0383,0.0454,0.0870,0.0897,0.1700,0.1064,0.0420,0.0726,0.0371,0.6475,0.2947]
# ssA_WLS = [0,0.3097,0.2556,0.2556,0.2555,0.2555,0.1811,0.1178,0.0448,0.0448,0.0272,0.0732,0.0333,0.0391,0.0081,0.2396,0.2295,71.1775,6.3506,6.3492,3.6650,3.6649,0.4173,0.2599,0.0889,0.0889,0.2952,0.2952,0.2646,0.0893,0.3092,0.2557,0.1574,0.0630,0.0548,0.0609,0.0189,0.0172,0.0069,0.9515,0.6041]
#====================================25%
# ssA_MLP = [0,0.0667,0.0639,0.0507,0.0547,0.0654,0.6339,0.1540,0.2406,0.2863,0.2446,0.4195,0.2024,0.4108,0.1702,0.4131,0.7638,0.4269,0.0006,1.6238,1.7514,1.6610,0.2130,0.1156,0.1324,0.1296,0.1391,0.1027,0.0923,0.3061,0.1769,0.0489,0.1518,0.1512,1.2382,0.2877,1.0603,0.8889,0.4575,0.7442,0.1924]
# ssA_RFR = [0,0.0529,0.0456,0.0457,0.0457,0.0457,0.0839,0.0231,0.0549,0.0549,0.0035,0.0219,0.0539,0.0287,0.0076,0.0129,0.0126,1.1600,1.1561,1.1558,2.7315,2.7314,0.2868,0.0440,0.2293,0.2293,0.0336,0.0336,0.0302,0.2006,0.0392,0.0457,0.0886,0.0865,0.1030,0.0953,0.0334,0.0746,0.0423,0.6642,0.2752]
# ssA_WLS = [0,0.3097,0.2556,0.2556,0.2555,0.2555,0.1811,0.1178,0.0448,0.0448,0.0272,0.0732,0.0333,0.0391,0.0081,0.2396,0.2295,71.1775,6.3506,6.3492,3.6650,3.6649,0.4173,0.2599,0.0889,0.0889,0.2952,0.2952,0.2646,0.0893,0.3092,0.2557,0.1574,0.0630,0.0548,0.0609,0.0189,0.0172,0.0069,0.9515,0.6041]
#====================================50%
# ssA_RFR = [0,0.05290,0.04556,0.04570,0.04570,0.04570,0.08408,0.02353,0.05499,0.05499,0.02262,0.02910,0.05486,0.04180,0.00753,0.01281,0.01256,1.16106,4.55370,4.55275,2.73139,2.73128,0.28583,0.04395,0.22925,0.22925,0.03357,0.03357,0.03016,0.20056,0.03933,0.04569,0.08831,0.08688,0.10135,0.09502,0.03297,0.07558,0.00589,0.66263,0.27156]
# ssA_MLP = [0,0.3977,0.3106,0.3105,0.3153,0.3148,0.1891,0.6217,0.0237,0.0509,0.4254,0.5334,0.1076,0.2096,0.9914,0.3418,0.9716,6.2312,3.9739,4.1729,2.0758,2.9068,0.0071,0.2446,0.4013,0.3944,0.3215,0.3242,0.3417,0.4242,0.2165,0.3178,1.1427,0.4899,0.2733,0.6199,0.6821,0.3996,1.4488,2.3553,0.0083]
# ssA_WLS = [0,0.3097,0.2556,0.2556,0.2555,0.2555,0.1811,0.1178,0.0448,0.0448,0.0272,0.0732,0.0333,0.0391,0.0081,0.2396,0.2295,71.1775,6.3506,6.3492,3.6650,3.6649,0.4173,0.2599,0.0889,0.0889,0.2952,0.2952,0.2646,0.0893,0.3092,0.2557,0.1574,0.0630,0.0548,0.0609,0.0189,0.0172,0.0069,0.9515,0.6041]
#====================================25% 50%data
ssA_MLP = [0,0.8612,0.8591,0.8709,0.8717,0.8643,0.8620,0.8830,0.8815,0.8810,0.8667,0.8651,0.8664,0.8693,0.9231,0.8715,0.9042,0.9155,0.9317,0.8847,0.8682,0.8468,0.8170,0.5756,0.8488,0.8587,0.8596,0.8623,0.8668,0.9103,0.8687,0.8561,1.0343,1.2244,1.2185,1.2188,1.2203,0.9762,3.2085,3.6127,4.1813,4.4484,1.5642,2.3237,2.4807,2.6628,2.2674,3.5574,2.0590,2.1606,2.9197,2.7644,2.5682,1.8769,1.7733,1.8757,2.1699,3.7511,0.3757,1.2747,1.2158,1.2644,1.0278,1.1440,0.4647,0.1462,1.4561,0.4590,0.8592,0.0641,0.3132,0.0064,0.3127,0.2595,0.3390,0.7389,0.1034,0.0373,0.1548,0.5881,0.5572,1.3389,1.5432,2.2007,2.5218,2.9161,3.1098,3.9071,1.2615,0.3360,1.1304,0.7911,1.7214,3.6584,1.1091,2.1094,2.8414,0.0067,0.8724,1.5561,1.2437,1.3582,1.2943,1.0809,0.9940,0.9055,0.9005,0.9354,0.9415,1.0139,1.0040,0.9989,0.9001,0.8553,0.8551,0.4607,0.8636,0.8639]
ssA_RFR = [0,0.105128,0.10474424,0.1046823,0.10443,0.10580131,0.10558373,0.10112224,0.1020817,0.10217159,0.10482068,0.10483822,0.10338115,0.10308061,0.09603909,0.10231686,0.09555497,0.09545083,0.09481018,0.09344793,0.0917534,0.08945804,0.08450984,0.07285704,0.09055593,0.09041624,0.09914219,0.10072015,0.10119915,0.09147888,0.10116834,0.09758448,0.08785611,0.07597674,0.07742334,0.07774192,0.07631726,0.07335929,0.07062295,0.06757538,0.06566093,0.05624631,0.06628625,0.05206613,0.04764124,0.04051845,0.03300979,0.03846815,0.03746806,0.03725737,0.03730407,0.03801065,0.0385154,0.03786293,0.03707886,0.03753077,0.0370577,0.03686501,0.03313595,0.03235014,0.03191117,0.03257599,0.03219535,0.03161252,0.0303828,0.03406142,0.03355071,0.02172735,0.10520326,0.02498567,0.02944058,0.05095885,0.02900657,0.02121365,0.01688465,0.01806985,0.01604584,0.01620902,0.01573324,0.01832419,0.02048504,0.01745376,0.01728768,0.01765695,0.01875768,0.01958743,0.01941959,0.01832227,0.0181922,0.01634083,0.01812814,0.01962352,0.02033114,0.02088743,0.02111511,0.02011817,0.01897874,0.02001839,0.02255246,0.02270992,0.02087309,0.01983918,0.02427074,0.02503191,0.02555323,0.02358422,0.02412208,0.02639948,0.02763284,0.02906922,0.02898804,0.03044838,0.09639065,0.10010969,0.10034204,0.02224253,0.10547628,0.01777346]
ssA_WLS = [0,0.8612,0.8591,0.8709,0.8717,0.8643,0.8620,0.8830,0.8815,0.8810,0.8667,0.8651,0.8664,0.8693,0.9231,0.8715,0.9042,0.9155,0.9317,0.8847,0.8682,0.8468,0.8170,0.5756,0.8488,0.8587,0.8596,0.8623,0.8668,0.9103,0.8687,0.8561,1.0343,1.2244,1.2185,1.2188,1.2203,0.9762,3.2085,3.6127,4.1813,4.4484,1.5642,2.3237,2.4807,2.6628,2.2674,3.5574,2.0590,2.1606,2.9197,2.7644,2.5682,1.8769,1.7733,1.8757,2.1699,3.7511,0.3757,1.2747,1.2158,1.2644,1.0278,1.1440,0.4647,0.1462,1.4561,0.4590,0.8592,0.0641,0.3132,0.0064,0.3127,0.2595,0.3390,0.7389,0.1034,0.0373,0.1548,0.5881,0.5572,1.3389,1.5432,2.2007,2.5218,2.9161,3.1098,3.9071,1.2615,0.3360,1.1304,0.7911,1.7214,3.6584,1.1091,2.1094,2.8414,0.0067,0.8724,1.5561,1.2437,1.3582,1.2943,1.0809,0.9940,0.9055,0.9005,0.9354,0.9415,1.0139,1.0040,0.9989,0.9001,0.8553,0.8551,0.4607,0.8636,0.8639]
i = np.ones((118, 1), dtype=int)
for n in range(118):
    i[n] = n+1



plt.plot(i, ssA_MLP, 'bo-', label='MLP')
plt.plot(i, ssA_RFR, 'yo-', label='RFR')
plt.plot(i, ssA_WLS, 'go-', label='WLS')
# plt.title('Sai số góc pha của của lưới Tây Ninh')
plt.xlabel('Bus')
plt.ylabel('Angle (degree)')
plt.legend(loc='best')
plt.show()